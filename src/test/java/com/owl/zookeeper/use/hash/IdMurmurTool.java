package com.owl.zookeeper.use.hash;

import java.util.SortedMap;
import java.util.TreeMap;

import com.google.common.hash.HashFunction;
import com.google.common.hash.Hashing;

/**
 * 一致性 murmurHash 算法.
 *
 * 提取出来,用来应对将来mycat扩容时,数据根据主键id重新做分片分库.
 *
 * @author tan liansheng on 2017/12/8 15:24
 */
public class IdMurmurTool {

    private static final int DEFAULT_VIRTUAL_BUCKET_TIMES = 160;

    private static final int DEFAULT_WEIGHT = 1;

    private static int virtualBucketTimes = DEFAULT_VIRTUAL_BUCKET_TIMES;

    private static HashFunction hash;

    // 一致性Hash环
    //虚拟节点-真实节点映射
    private static SortedMap<Integer, Integer> bucketMap = new TreeMap<Integer, Integer>();

    static {

        final int seed = 0;

        // 几个库就写几 如果不清楚就看mycat配置文件rule.xml中配的多少(搜关键字PartitionByMurmurHash)
        final int count = 3;

        hash = Hashing.murmur3_32(seed);//计算一致性哈希的对象
        for (int i = 0; i < count; i++) {//构造一致性哈希环，用TreeMap表示
            StringBuilder hashName = new StringBuilder("SHARD-").append(i);
            for (int n = 0, shard = virtualBucketTimes * getWeight(i); n < shard; n++) {
                bucketMap.put(hash.hashUnencodedChars(hashName.append("-NODE-").append(n)).asInt(), i);
            }
        }
    }

    private static int getWeight(int databaseNo){
        // 如果权重不同 自己根据入参写逻辑 这里默认为1
        return DEFAULT_WEIGHT;
    }


    /**
     * 核心方法 根据传入的id判断条记录的归属库的编号
     *
     * @param objectId
     * @return 从0开始数
     */
    public static int calculate(String objectId){

        int i = hash.hashUnencodedChars(objectId).asInt();

        //从桶里拿 key大于or等于i的一组数据 具体看tailMap的注释
        SortedMap<Integer, Integer> tail = bucketMap.tailMap(i);
        if (tail.isEmpty()) {
            return bucketMap.get(bucketMap.firstKey());
        }
        return tail.get(tail.firstKey());
    }

    public static void main(String[] args) {
        String str = "1,\n" +
                "0,\n" +
                "2,\n" +
                "3,\n" +
                "4,\n" +
                "5,\n" +
                "6,\n" +
                "7,\n" +
                "8,\n" +
                "9,\n" +
                "10,\n" +
                "11,\n" +
                "12,\n" +
                "992325036183879680,\n" +
                "992325003451531264,\n" +
                "977125614235783168,\n" +
                "977125071709622272,\n" +
                "977121767442575360,\n" +
                "977112682757308416,\n" +
                "977106057992081408,\n" +
                "976735218797277184,\n" +
                "976726998391934976,\n" +
                "976716469662744576,\n" +
                "976713328470732800,\n" +
                "976712582123696128,\n" +
                "976698327181869056,\n" +
                "976665156733145088,\n" +
                "976398013919547392,\n" +
                "976372000459853824,\n" +
                "976359189518372864,\n" +
                "976358437207138304,\n" +
                "976330412706160640,\n" +
                "976037478614814720,\n" +
                "976007390331551744,\n" +
                "976000776155009024,\n" +
                "975995849257725952,\n" +
                "975985461208317952,\n" +
                "975970911483490304,\n" +
                "975969479507537920,\n" +
                "975968645067620352,\n" +
                "975931636281720832,\n" +
                "975917501639204864,\n" +
                "975652462335340544,\n" +
                "975645025595273216,\n" +
                "975639021407154176,\n" +
                "975634417156608000,\n" +
                "975631789863264256,\n" +
                "975631758607310848,\n" +
                "975628218581741568,\n" +
                "974567146001096704,\n" +
                "974566758233497600,\n" +
                "974557041471725568,\n" +
                "974556615131299840,\n" +
                "974555495563444224,\n" +
                "974554447020539904,\n" +
                "974552564449710080,\n" +
                "974537993642012672,\n" +
                "974537987455414272,\n" +
                "974531840122675200,\n" +
                "974524542887051264,\n" +
                "974521156311191552,\n" +
                "974519637669502976,\n" +
                "974519057685733376,\n" +
                "974518858368561152,\n" +
                "974516161021755392,\n" +
                "974491989436502016,\n" +
                "974491675073019904,\n" +
                "974489726468382720,\n" +
                "974484371334246400,\n" +
                "974483006242783232,\n" +
                "974482675202850816,\n" +
                "974482670085799936,\n" +
                "974481727909715968,\n" +
                "974469528838156288,\n" +
                "974454860222058496,\n" +
                "974454841716789248,\n" +
                "974229485194301440,\n" +
                "974228865296318464,\n" +
                "974227355341901824,\n" +
                "974225334326771712,\n" +
                "974224584814051328,\n" +
                "974224578619064320,\n" +
                "974222521265225728,\n" +
                "974220671033237504,\n" +
                "974220145741127680,\n" +
                "974219852270039040,\n" +
                "974219848566468608,\n" +
                "974219451399553024,\n" +
                "974217701959155712,\n" +
                "974216554988482560,\n" +
                "974213846424469504,\n" +
                "974210925498458112,\n" +
                "974210464225542144,\n" +
                "974209716179415040,\n" +
                "974209710491938816,\n" +
                "974208699203551232,\n" +
                "974206791818096640,\n" +
                "974204939148652544,\n" +
                "974204913580175360,\n" +
                "974204551328665600,\n" +
                "974204547050475520,\n" +
                "974204024084951040,\n" +
                "974203719153455104,\n" +
                "974192362519457792,\n" +
                "974192358962688000,\n" +
                "974190576129523712,\n" +
                "974185968559841280,\n" +
                "974185955687522304,\n" +
                "974183253015769088,\n" +
                "974181552958275584,\n" +
                "974180924605669376,\n" +
                "974180586365247488,\n" +
                "974177246577324032,\n" +
                "974177108396376064,\n" +
                "974127672663547904,\n" +
                "974124408827125760,\n" +
                "974124367538397184,\n" +
                "974112591205765120,\n" +
                "974106396390395904,\n" +
                "974104946288283648,\n" +
                "974103041418461184,\n" +
                "974098970181836800,\n" +
                "974098740185382912,\n" +
                "974097975406632960,\n" +
                "974096276284706816,\n" +
                "974095609926471680,\n" +
                "974095597897207808,\n" +
                "974091877130911744,\n" +
                "973861126466297856,\n" +
                "973860103283384320,\n" +
                "973859291334696960,\n" +
                "973856659292360704,\n" +
                "973853922580205568,\n" +
                "973850192633462784,\n" +
                "973849140844625920,\n" +
                "973838704638074880,\n" +
                "973826583280623616,\n" +
                "973809916692439040,\n" +
                "973803291453161472,\n" +
                "973800214650609664,\n" +
                "973118874608730112,\n" +
                "973109391784628224,\n" +
                "973079284392484864,\n" +
                "973078560694165504,\n" +
                "973010413445087232,\n" +
                "971939856864260096,\n" +
                "966975084144173056,\n" +
                "966971093291638784,\n" +
                "966958249583763456,\n" +
                "966952539351044096,\n" +
                "961876482131312640,\n" +
                "961484173698838528,\n" +
                "961425534562168832,\n" +
                "961423114480754688,\n" +
                "961421007867719680,\n" +
                "961138570954067968,\n" +
                "961132368442478592,\n" +
                "960488959539445760,\n" +
                "960485822491643904,\n" +
                "960455871231205376,\n" +
                "960444549781299200,\n" +
                "960444539035492352,\n" +
                "960435406343602176,\n" +
                "960431129137864704,\n" +
                "960427401592483840,\n" +
                "960398411896483840,\n" +
                "960397687067283456,\n" +
                "960393670626152448,\n" +
                "960392738269179904,\n" +
                "960387314830311424,\n" +
                "960387269250809856,\n" +
                "960358331058454528,\n" +
                "960352916335878144,\n" +
                "960352906244382720,\n" +
                "960351706389766144,\n" +
                "959395382661472256,\n" +
                "959395359483748352,\n" +
                "959035594511048704,\n" +
                "958898885666299904,\n" +
                "958897240028106752,\n" +
                "958896911059472384,\n" +
                "958878981408780288,\n" +
                "958878973905170432,\n" +
                "958878952455499776,\n" +
                "958874193132281856,\n" +
                "958874121762004992,\n" +
                "958868583653625856,\n" +
                "958867797838188544,\n" +
                "958867107665465344,\n" +
                "958866741376897024,\n" +
                "958685098949496832,\n" +
                "958684322602668032,\n" +
                "958684281246830592,\n" +
                "958684117287292928,\n" +
                "958678135661010944,\n" +
                "958678070812876800,\n" +
                "958678000818331648,\n" +
                "958677588425973760,\n" +
                "958643875353817088,\n" +
                "958643598059991040,\n" +
                "958639286213390336,\n" +
                "958619676500537344,\n" +
                "958281448397459456,\n" +
                "958272231326339072,\n" +
                "957166035700289536,\n" +
                "957164934932516864,\n" +
                "957162994491899904,\n" +
                "957155410185867264,\n" +
                "957155384458006528,\n" +
                "957155357371191296,\n" +
                "956773098368106496,\n" +
                "956773019624243200,\n" +
                "956733728922304512,\n" +
                "956536762964828160,\n" +
                "956532769779421184,\n" +
                "956526749461381120,\n" +
                "956467867325517824,\n" +
                "956467826393305088,\n" +
                "956467766406369280,\n" +
                "956467746365984768,\n" +
                "956467724589158400,\n" +
                "956467703537946624,\n" +
                "956467683313012736,\n" +
                "956467641734877184,\n" +
                "956467566568755200,\n" +
                "956467487858446336,\n" +
                "956467394690371584,\n" +
                "956467327350820864,\n" +
                "956467298649198592,\n" +
                "956467236665774080,\n" +
                "956467173256286208,\n" +
                "956467120349335552,\n" +
                "956465228228902912,\n" +
                "956465202454904832,\n" +
                "956465137300586496,\n" +
                "956465037480345600,\n" +
                "956464929338605568,\n" +
                "956464886955163648,\n" +
                "956464875957698560,\n" +
                "956464850812846080,\n" +
                "956464841686040576,\n" +
                "956464812577570816,\n" +
                "956464799352930304,\n" +
                "956463409716432896,\n" +
                "956430155018305536,\n" +
                "956430147565027328,\n" +
                "956429911987818496,\n" +
                "956429685974851584,\n" +
                "956429662235090944,\n" +
                "956429416049262592,\n" +
                "956429404007415808,\n" +
                "956429133098926080,\n" +
                "956429127172374528,\n" +
                "956428635954262016,\n" +
                "956428630480695296,\n" +
                "956428622498934784,\n" +
                "956428343201587200,\n" +
                "956427709900398592,\n" +
                "956427682658394112,\n" +
                "956425042388348928,\n" +
                "956425019864936448,\n" +
                "956414863664500736,\n" +
                "956411566002929664,\n" +
                "956408768661450752,\n" +
                "955768538586951680,\n" +
                "955738288401293312,\n" +
                "955738256784629760,\n" +
                "955718153545392128,\n" +
                "955718116186726400,\n" +
                "955678611490820096,\n" +
                "955678554410536960,\n" +
                "955678519660728320,\n" +
                "955678469513629696,\n" +
                "955676700127543296,\n" +
                "955676675460841472,\n" +
                "955665023848456192,\n" +
                "955664695858077696,\n" +
                "954271954306019328,\n" +
                "954271345685852160,\n" +
                "953148592645083136,\n" +
                "953084612930007040,\n" +
                "953078227843801088,\n" +
                "952801555068755968,\n" +
                "951722368163487744,\n" +
                "951719626603700224,\n" +
                "951646507318968320,\n" +
                "950984700774350848,\n" +
                "950983885291958272,\n" +
                "950981331993247744,\n" +
                "950978490642354176,\n" +
                "950286252919074816,\n" +
                "950284012170612736,\n" +
                "950266132683255808,\n" +
                "948822416013950976,\n" +
                "945599771527962624,\n" +
                "940867736120905728,\n" +
                "940781171689410560,\n" +
                "940775200009711616,\n" +
                "940764689726390272,\n" +
                "940761464312709120,\n" +
                "940525841095442432,\n" +
                "940525311560474624,\n" +
                "937857024000806912,\n" +
                "931064338182377472,\n" +
                "930610342832156672,\n" +
                "930608481682546688,\n" +
                "930339426412736512,\n" +
                "930248699685830656,\n" +
                "930246995670720512,\n" +
                "928540655967481856,\n" +
                "928456041301426176,\n" +
                "928452397968764928,\n" +
                "927430005304016896,\n" +
                "923450217740169216,\n" +
                "923374631601405952,\n" +
                "923369755449311232,\n" +
                "923182312139739136,\n" +
                "923168445768372224,\n" +
                "923146970451095552,\n" +
                "923120789686824960,\n" +
                "922361721359474688,\n" +
                "921301785609363456,\n" +
                "921018480429871104,\n" +
                "921006946973528064,\n" +
                "920988375604113408,\n" +
                "920977597693833216,\n" +
                "920575532001132544,\n" +
                "920562421088489472,\n" +
                "920474794876985344,\n" +
                "920469936671670272,\n" +
                "920280608246616064,\n" +
                "920279004588269568,\n" +
                "920276788674134016,\n" +
                "920214373543739392,\n" +
                "920207024284094464,\n" +
                "920201724800479232,\n" +
                "920162021171085312,\n" +
                "919819661309673472,\n" +
                "919433892476989440,\n" +
                "919011959165841408,\n" +
                "918716765303746560,\n" +
                "918716765272834048,\n" +
                "918644394131730432,\n" +
                "918456326183174144,\n" +
                "918438458992414720,\n" +
                "918382690055139328,\n" +
                "918359719592767488,\n" +
                "918359716107661312,\n" +
                "918320078375321600,\n" +
                "918320078341025792,\n" +
                "918307440477593600,\n" +
                "918303225213739008,\n" +
                "918289815257071616,\n" +
                "918287576670478336,\n" +
                "918093287829979136,\n" +
                "918080066347778048,\n" +
                "918072555777044480,\n" +
                "918072555766988800,\n" +
                "918061101638664192,\n" +
                "918059855932043264,\n" +
                "918050947263901696,\n" +
                "918049681422999552,\n" +
                "918046260774199296,\n" +
                "918041920731623424,\n" +
                "918026094737633280,\n" +
                "917955383333081088,\n" +
                "917947474303160320,\n" +
                "917937567343878144,\n" +
                "917936734523977728,\n" +
                "917935060031553536,\n" +
                "917929539591327744,\n" +
                "917924807169155072,\n" +
                "917923013785202688,\n" +
                "917920732200542208,\n" +
                "917718736608514048,\n" +
                "917717748624474112,\n" +
                "917708855271006208,\n" +
                "917700805632241664,\n" +
                "917693829091340288,\n" +
                "917678570316947456,\n" +
                "917676006131429376,\n" +
                "917652271057776640,\n" +
                "917633008596070400,\n" +
                "917590211057287168,\n" +
                "917219314737774592,\n" +
                "917208031872651264,\n" +
                "916854012470996992,\n" +
                "916560073274744832,\n" +
                "914066542886260736,\n" +
                "914037071379136512,\n" +
                "914008545100251136,\n" +
                "913946824740974592,\n" +
                "913669988384264192,\n" +
                "913572607026298880,\n" +
                "913316048758829056,\n" +
                "913237241120432128,\n" +
                "913207840776548352,\n" +
                "912977384953769984,\n" +
                "912975586170830848,\n" +
                "912975559101558784,\n" +
                "912966325984743424,\n" +
                "912918729211445248,\n" +
                "912885752941363200,\n" +
                "911152431989379072,\n" +
                "911148271926906880,\n" +
                "911033286169612288,\n" +
                "910743356304908288,\n" +
                "910477462806515712,\n" +
                "910044105875423232,\n" +
                "910022728146694144,\n" +
                "910015298721918976,\n" +
                "909986912623988736,\n" +
                "909980683231375360,\n" +
                "909615526417362944,\n" +
                "909595706713911296,\n" +
                "909591836865429504,\n" +
                "908955049685004288,\n" +
                "908946873945448448,\n" +
                "908928034610733056,\n" +
                "908882829806419968,\n" +
                "908523563199242240,\n" +
                "908516895180242944,\n" +
                "908511186255966208,\n" +
                "908507352663965696,\n" +
                "908302545025953792,\n" +
                "908142109184892928,\n" +
                "907532123938525184,\n" +
                "907507511050182656,\n" +
                "907429147689046016,\n" +
                "907184590052843520,\n" +
                "907148854627934208,\n" +
                "907148003826212864,\n" +
                "907140297733873664,\n" +
                "907120922372497408,\n" +
                "907120483692978176,\n" +
                "907119420004900864,\n" +
                "907086617683349504,\n" +
                "907084326880776192,\n" +
                "906081268652806144,\n" +
                "906062852320235520,\n" +
                "906052036376236032,\n" +
                "906048619050274816,\n" +
                "906048221751336960,\n" +
                "906045847154892800,\n" +
                "906037858930364416,\n" +
                "905994210611728384,\n" +
                "905992438881628160,\n" +
                "905984618365612032,\n" +
                "905982105035046912,\n" +
                "905980348590555136,\n" +
                "905978544829636608,\n" +
                "905758082674032640,\n" +
                "905755331840716800,\n" +
                "905748449088516096,\n" +
                "905395007079530496,\n" +
                "905246090241949696,\n" +
                "905052678528864256,\n" +
                "905052163338309632,\n" +
                "905038186653278208,\n" +
                "904684073124020224,\n" +
                "904675462675087360,\n" +
                "904670910148165632,\n" +
                "904599329950810112,\n" +
                "899456803760697344,\n" +
                "898744398151995392,\n" +
                "898024274390401024,\n" +
                "897723797016784896,\n" +
                "897720007313625088,\n" +
                "897697155430563840,\n" +
                "896264550236856320,\n" +
                "896255408170196992,\n" +
                "895944190506524672,\n" +
                "895938101115715584,\n" +
                "895930540512628736,\n" +
                "895923151542140928,\n" +
                "895615845638778880,\n" +
                "895570987617665024,\n" +
                "895561651458719744,\n" +
                "895206322783068160,\n" +
                "895187450014687232,\n" +
                "895126959414169600,\n" +
                "894847666604154880,\n" +
                "894845274723868672,\n" +
                "894814951524188160,\n" +
                "894498510983520256,\n" +
                "894455824289079296,\n" +
                "894439665942413312,\n" +
                "894431699379019776,\n" +
                "894398062441275392,\n" +
                "894378350237478912,\n" +
                "893674262982414336,\n" +
                "893673892584779776,\n" +
                "893672722352553984,\n" +
                "893666590482268160,\n" +
                "893655617850318848,\n" +
                "893643950622769152,\n" +
                "893448572027695104,\n" +
                "893444251130019840,\n" +
                "893438944240578560,\n" +
                "893376296284307456,\n" +
                "893368321622888448,\n" +
                "893321603986604032,\n" +
                "893086329242525696,\n" +
                "893068028442476544,\n" +
                "887706343835238400,\n" +
                "887706291708428288,\n" +
                "887706095150759936,\n" +
                "887706073239715840,\n" +
                "887705773766410240,\n" +
                "887705705944514560,\n" +
                "887705426180243456,\n" +
                "887705406609620992,\n" +
                "887705003226628096,\n" +
                "887704641364738048,\n" +
                "887704522416783360,\n" +
                "887704497808801792,\n" +
                "887704378417938432,\n" +
                "887703545160728576,\n" +
                "887702865075306496,\n" +
                "887702750231068672,\n" +
                "887702733793591296,\n" +
                "887702681578700800,\n" +
                "887702314396745728,\n" +
                "887702105394577408,\n" +
                "887701865010626560,\n" +
                "887701678733582336,\n" +
                "887701656574689280,\n" +
                "887701299291291648,\n" +
                "887701003416698880,\n" +
                "887700941307445248,\n" +
                "887700594824765440,\n" +
                "887700215764156416,\n" +
                "887700108108955648,\n" +
                "887699824905355264,\n" +
                "887699383626825728,\n" +
                "887699270544195584,\n" +
                "887699184678404096,\n" +
                "887698982890438656,\n" +
                "887698938670276608,\n" +
                "887698842131283968,\n" +
                "887698409734602752,\n" +
                "887698075353792512,\n" +
                "887698018817081344,\n" +
                "887697949540147200,\n" +
                "887697884456747008,\n" +
                "887697853410508800,\n" +
                "887697278607998976,\n" +
                "887697222453354496,\n" +
                "887697017443778560,\n" +
                "887696945196892160,\n" +
                "887696743513784320,\n" +
                "887696625590927360,\n" +
                "887696618611605504,\n" +
                "887695806611128320,\n" +
                "887695735115022336,\n" +
                "887695424673611776,\n" +
                "887695027674349568,\n" +
                "887694920258224128,\n" +
                "887694262046097408,\n" +
                "887693984303480832,\n" +
                "887693961140027392,\n" +
                "887693951092981760,\n" +
                "887693950493196288,\n" +
                "887693930238902272,\n" +
                "887693886009966592,\n" +
                "887693617071194112,\n" +
                "887693438343512064,\n" +
                "887693413309399040,\n" +
                "887693413087100928,\n" +
                "887693379895885824,\n" +
                "887693268272873472,\n" +
                "887693229869826048,\n" +
                "887693220520722432,\n" +
                "887693177109676032,\n" +
                "887693066250027008,\n" +
                "887692976513277952,\n" +
                "887692637306945536,\n" +
                "887692494127677440,\n" +
                "887692260452925440,\n" +
                "887692049152278528,\n" +
                "887692009314779136,\n" +
                "887691925168652288,\n" +
                "887691480094277632,\n" +
                "887691395432251392,\n" +
                "887691364377624576,\n" +
                "887691345423949824,\n" +
                "887691299315580928,\n" +
                "887691170479144960,\n" +
                "887691119396716544,\n" +
                "887691064430362624,\n" +
                "887690943902842880,\n" +
                "887690629279711232,\n" +
                "887690411347869696,\n" +
                "887690367039242240,\n" +
                "887690364975644672,\n" +
                "887690158997569536,\n" +
                "887690136025366528,\n" +
                "887690018349973504,\n" +
                "887689718620815360,\n" +
                "887689457789632512,\n" +
                "887689365615607808,\n" +
                "887689318450659328,\n" +
                "887689183280824320,\n" +
                "887689124019503104,\n" +
                "887689019451695104,\n" +
                "887688888597413888,\n" +
                "887688598053781504,\n" +
                "887688582383861760,\n" +
                "887688560980328448,\n" +
                "887687991939104768,\n" +
                "887687588829126656,\n" +
                "887687471788376064,\n" +
                "887687463762984960,\n" +
                "887687074539962368,\n" +
                "887686708142342144,\n" +
                "887686619801911296,\n" +
                "887686601128869888,\n" +
                "887686483810377728,\n" +
                "887686403291938816,\n" +
                "887686109803905024,\n" +
                "887685888034275328,\n" +
                "887685746107416576,\n" +
                "887685524690108416,\n" +
                "887685372956966912,\n" +
                "887685305818742784,\n" +
                "887685169337778176,\n" +
                "887685114696892416,\n" +
                "887685076482588672,\n" +
                "887685041816666112,\n" +
                "887684957196967936,\n" +
                "887684910363369472,\n" +
                "887684871800553472,\n" +
                "887684836434182144,\n" +
                "887684536822464512,\n" +
                "887684388125999104,\n" +
                "887684352944177152,\n" +
                "887684339912474624,\n" +
                "887684250682851328,\n" +
                "887684181032239104,\n" +
                "887684154222247936,\n" +
                "887683905735286784,\n" +
                "887683684682498048,\n" +
                "887683502716813312,\n" +
                "887683477278744576,\n" +
                "887683403945148416,\n" +
                "887683243706343424,\n" +
                "887682919452704768,\n" +
                "887682793569058816,\n" +
                "887682729027108864,\n" +
                "887682607891800064,\n" +
                "887682515897745408,\n" +
                "887682260242718720,\n" +
                "887682210674049024,\n" +
                "887682028729335808,\n" +
                "887682004570144768,\n" +
                "887681684847124480,\n" +
                "887681665976565760,\n" +
                "887681613959192576,\n" +
                "887681555955777536,\n" +
                "887681555355992064,\n" +
                "887681384668790784,\n" +
                "887681121451048960,\n" +
                "887681077117255680,\n" +
                "887681054283464704,\n" +
                "887681031916929024,\n" +
                "887681026785607680,\n" +
                "887680685297958912,\n" +
                "887680684140331008,\n" +
                "887680608273760256,\n" +
                "887680597721276416,\n" +
                "887680536171167744,\n" +
                "887680520679915520,\n" +
                "887680492842319872,\n" +
                "887680341784461312,\n" +
                "887680209273815040,\n" +
                "887680179888521216,\n" +
                "887680169706438656,\n" +
                "887680080949469184,\n" +
                "887679969749696512,\n" +
                "887679968021643264,\n" +
                "887679885213884416,\n" +
                "887679877995102208,\n" +
                "887679786417053696,\n" +
                "887679713263812608,\n" +
                "887679671866417152,\n" +
                "887679635371393024,\n" +
                "887679626124640256,\n" +
                "887679444438286336,\n" +
                "887679385719717888,\n" +
                "887679329334001664,\n" +
                "887679293195878400,\n" +
                "887679274468696064,\n" +
                "887679252041367552,\n" +
                "887678938353565696,\n" +
                "887678852487774208,\n" +
                "887678827506499584,\n" +
                "887678820451680256,\n" +
                "887678792127545344,\n" +
                "887678752430145536,\n" +
                "887678642907176960,\n" +
                "887678638521237504,\n" +
                "887678609834704896,\n" +
                "887678603463942144,\n" +
                "887678495171207168,\n" +
                "887678417635303424,\n" +
                "887678341105647616,\n" +
                "887678335147229184,\n" +
                "887678236005163008,\n" +
                "887678142371135488,\n" +
                "887678052868882432,\n" +
                "887677934987968512,\n" +
                "887677904912302080,\n" +
                "887677789680500736,\n" +
                "887677754423566336,\n" +
                "887677657996132352,\n" +
                "887677642309435392,\n" +
                "887677633547534336,\n" +
                "887677548244164608,\n" +
                "887677525951053824,\n" +
                "887677410683191296,\n" +
                "887677362532581376,\n" +
                "887677221876596736,\n" +
                "887677113785188352,\n" +
                "887677088363511808,\n" +
                "887676955722842112,\n" +
                "887676947212599296,\n" +
                "887676939117592576,\n" +
                "887676850097684480,\n" +
                "887676755117670400,\n" +
                "887676602923155456,\n" +
                "887676542835941376,\n" +
                "887676403853099008,\n" +
                "887676342687563776,\n" +
                "887676282822262784,\n" +
                "887676261893070848,\n" +
                "887676012860080128,\n" +
                "887675875324657664,\n" +
                "887675851157078016,\n" +
                "887675786032119808,\n" +
                "887675748333715456,\n" +
                "887675729984020480,\n" +
                "887675714099806208,\n" +
                "887675590858571776,\n" +
                "887675207541129216,\n" +
                "887675068915187712,\n" +
                "887674955291877376,\n" +
                "887674782155202560,\n" +
                "887674723002548224,\n" +
                "887674689158709248,\n" +
                "887674684326871040,\n" +
                "887674683639005184,\n" +
                "887674682489765888,\n" +
                "887674520782954496,\n" +
                "887674369380777984,\n" +
                "887674354902040576,\n" +
                "887674211817553920,\n" +
                "887674106376945664,\n" +
                "887674045790224384,\n" +
                "887673984771489792,\n" +
                "887673953062551552,\n" +
                "887673921043234816,\n" +
                "887673900596002816,\n" +
                "887673615999893504,\n" +
                "887673577622011904,\n" +
                "887673523075088384,\n" +
                "887673482851713024,\n" +
                "887673397220802560,\n" +
                "887673360248012800,\n" +
                "887673314710454272,\n" +
                "887673274650656768,\n" +
                "887673271425236992,\n" +
                "887673248328892416,\n" +
                "887673231197667328,\n" +
                "887673122166734848,\n" +
                "887673104353525760,\n" +
                "887672934366773248,\n" +
                "887672900367745024,\n" +
                "887672804175577088,\n" +
                "887672574302552064,\n" +
                "887672526937964544,\n" +
                "887672469331705856,\n" +
                "887672441464750080,\n" +
                "887672355636707328,\n" +
                "887672316780675072,\n" +
                "887672284703023104,\n" +
                "887672271431860224,\n" +
                "887672247197171712,\n" +
                "887672079081078784,\n" +
                "887671944016101376,\n" +
                "887671790269693952,\n" +
                "887671758141325312,\n" +
                "887671741565435904,\n" +
                "887671593363898368,\n" +
                "887671539051855872,\n" +
                "887671513873448960,\n" +
                "887671507732987904,\n" +
                "887671414197501952,\n" +
                "887671398181961728,\n" +
                "887671352514379776,\n" +
                "887671334709944320,\n" +
                "887671287687217152,\n" +
                "887671277583523840,\n" +
                "887671263331278848,\n" +
                "887671223279484928,\n" +
                "887671170615803904,\n" +
                "887671119680176128,\n" +
                "887671102902960128,\n" +
                "887671088113844224,\n" +
                "887670867088293888,\n" +
                "887670830260617216,\n" +
                "887670817346740224,\n" +
                "887670708978507776,\n" +
                "887670664493334528,\n" +
                "887670535805386752,\n" +
                "887670485020753920,\n" +
                "887670475812569088,\n" +
                "887670461296467968,\n" +
                "887670436998479872,\n" +
                "887670379583037440,\n" +
                "887670266580099072,\n" +
                "887670218665672704,\n" +
                "887670108399927296,\n" +
                "887670093283655680,\n" +
                "887670077546627072,\n" +
                "887670053770805248,\n" +
                "887670031568666624,\n" +
                "887670020777107456,\n" +
                "887669990248071168,\n" +
                "887669949528080384,\n" +
                "887669924240621568,\n" +
                "887669756812394496,\n" +
                "887669672938897408,\n" +
                "887669658984448000,\n" +
                "887669652328087552,\n" +
                "887669370256949248,\n" +
                "887669279391547392,\n" +
                "887669278276247552,\n" +
                "887669093525159936,\n" +
                "887669068317392896,\n" +
                "887669043558416384,\n" +
                "887669030551879680,\n" +
                "887669016954331136,\n" +
                "887668961732124672,\n" +
                "887668815300198400,\n" +
                "887668768123052032,\n" +
                "887668662528557056,\n" +
                "887668637178183680,\n" +
                "887668632067833856,\n" +
                "887668581656494080,\n" +
                "887668558688485376,\n" +
                "887668553185558528,\n" +
                "887668431379161088,\n" +
                "887668374466265088,\n" +
                "887668344325996544,\n" +
                "887668330090528768,\n" +
                "887668202718289920,\n" +
                "887668040931401728,\n" +
                "887668026435502080,\n" +
                "887668017786847232,\n" +
                "887668014313963520,\n" +
                "887668009649897472,\n" +
                "887667954427691008,\n" +
                "887667931587198976,\n" +
                "887667811804577792,\n" +
                "887667801600221184,\n" +
                "887667612273147904,\n" +
                "887667608519630848,\n" +
                "887667542542843904,\n" +
                "887667485756162048,\n" +
                "887667409298579456,\n" +
                "887667402772242432,\n" +
                "887667357087498240,\n" +
                "887667315345784832,\n" +
                "887667295401869312,\n" +
                "887667218130206720,\n" +
                "887667213432586240,\n" +
                "887667209347334144,\n" +
                "887667150887510016,\n" +
                "887667064383799296,\n" +
                "887667049020063744,\n" +
                "887667037909737472,\n" +
                "887667035929640960,\n" +
                "887667009447190528,\n" +
                "887666957470990336,\n" +
                "887666890693476352,\n" +
                "887666861924745216,\n" +
                "887666842199318528,\n" +
                "887666787861725184,\n" +
                "887666770577383424,\n" +
                "887666732266225664,\n" +
                "887666676148125696,\n" +
                "887666650797752320,\n" +
                "887666560795074560,\n" +
                "887666455526047744,\n" +
                "887666445271359488,\n" +
                "887666432612564992,\n" +
                "887666330225410048,\n" +
                "887666213489926144,\n" +
                "887666208993247232,\n" +
                "887666181080154112,\n" +
                "887666171471003648,\n" +
                "887666165741584384,\n" +
                "887666147676717056,\n" +
                "887666112994017280,\n" +
                "887666094381383680,\n" +
                "887666060611354624,\n" +
                "887666046891786240,\n" +
                "887665997675823104,\n" +
                "887665941270822912,\n" +
                "887665775118049280,\n" +
                "887665698546450432,\n" +
                "887665637247082496,\n" +
                "887665613255663616,\n" +
                "887665599687090176,\n" +
                "887665562996621312,\n" +
                "887665423475605504,\n" +
                "887665364848009216,\n" +
                "887665338742276096,\n" +
                "887665333763637248,\n" +
                "887665332312408064,\n" +
                "887665196106579968,\n" +
                "887665095560724480,\n" +
                "887664982079635456,\n" +
                "887664906464722944,\n" +
                "887664845979049984,\n" +
                "887664836567031808,\n" +
                "887664808184176640,\n" +
                "887664774617161728,\n" +
                "887664593570029568,\n" +
                "887664575701909504,\n" +
                "887664538294599680,\n" +
                "887664475013447680,\n" +
                "887664462266957824,\n" +
                "887664462176370688,\n" +
                "887664414246371328,\n" +
                "887664365621805056,\n" +
                "887664221519790080,\n" +
                "887664062541398016,\n" +
                "887664059609579520,\n" +
                "887664034892931072,\n" +
                "887664009890684928,\n" +
                "887663994104627200,\n" +
                "887663991217643520,\n" +
                "887663920174522368,\n" +
                "887663879301029888,\n" +
                "887663715548315648,\n" +
                "887663666242969600,\n" +
                "887663664948232192,\n" +
                "887663640632549376,\n" +
                "887663612148645888,\n" +
                "887663578774953984,\n" +
                "887663551889080320,\n" +
                "887663514438139904,\n" +
                "887663374214168576,\n" +
                "887663287681482752,\n" +
                "887663217376559104,\n" +
                "887663216856850432,\n" +
                "887663069728669696,\n" +
                "887663061910487040,\n" +
                "887663056957399040,\n" +
                "887663032646828032,\n" +
                "887662988602826752,\n" +
                "887662932356825088,\n" +
                "887662846680162304,\n" +
                "887662784323059712,\n" +
                "887662742853976064,\n" +
                "887662705466335232,\n" +
                "887662659756425216,\n" +
                "887662589615079424,\n" +
                "887662576734371840,\n" +
                "887662549715050496,\n" +
                "887662523189886976,\n" +
                "887662518618095616,\n" +
                "887662511316197376,\n" +
                "887662461815021568,\n" +
                "887662452348092416,\n" +
                "887662378771611648,\n" +
                "887662275155525632,\n" +
                "887662236756672512,\n" +
                "887662236429516800,\n" +
                "887662193479843840,\n" +
                "887662187934973952,\n" +
                "887662184453701632,\n" +
                "887662176614547456,\n" +
                "887662162311970816,\n" +
                "887662149955936256,\n" +
                "887662147095035904,\n" +
                "887662137398190080,\n" +
                "887662116640194560,\n" +
                "887662088697741312,\n" +
                "887662013070245888,\n" +
                "887661984288931840";
        String[] ids = str.split(",\n");
        for(String id : ids) {
            System.out.println(id + ":" + calculate(id));
        }
//        System.out.println("以下数据来自测试mysql库,用来验证计算的结果");
//
//        System.out.println("129 的库中主键id");
//        System.out.println();
//        // 129的库中主键id
//        System.out.println(calculate("00001B707C694368805A350655B8F60D"));
//        System.out.println(calculate("000169C84EE44A04A46D396033E8FA85"));
//        System.out.println(calculate("0002A7BC9ADA4B2ABD575A2175BF0A1A"));
//        System.out.println(calculate("0006B6EC270143A0B472AE1D71E5B4E1"));
//        System.out.println(calculate("000838819B324A7A96B58E02D55EB71B"));
//        System.out.println(calculate("000864B8F81246BA9DF277528A3CD5AB"));
//
//        System.out.println();
//
//        // 130库中主键id
//        System.out.println("130 的库中主键id");
//        System.out.println();
//        System.out.println(calculate("00001B707C694368805A350655B8F60C"));
//        System.out.println(calculate("0012F43CACA447F0B39F23DF24E9A341"));
//        System.out.println(calculate("003494E756E242F9BCCAA3599C7212A7"));
//        System.out.println(calculate("003C865C9DFE48D8A0D284D75F93972D"));
//        System.out.println(calculate("004F6A5F51FA41628ED61A35B7C044E9"));
//        System.out.println(calculate("0060CBF807B441A8B41BC8D302BE8FCD"));
    }

}
